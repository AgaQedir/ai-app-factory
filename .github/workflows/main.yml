name: FORCE DESIGN (CDN)
on:
  workflow_dispatch:
permissions:
  contents: write
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-python@v4
        with: { python-version: '3.9' }

      - name: Build With Forced Design
        run: |
          # Qovluğu təmizləyirik
          rm -rf app
          mkdir -p app

          # 1. LAYOUT (Dizaynı burdan məcburi yükləyirik)
          cat <<EOF > app/layout.tsx
          import React from 'react';
          export default function RootLayout({ children }: { children: React.ReactNode }) {
            return (
              <html lang="en">
                <head>
                  {/* BU SƏTİR DİZAYNI MƏCBURİ GƏTİRİR */}
                  <script src="https://cdn.tailwindcss.com"></script>
                  <script>{ \`tailwind.config = { theme: { extend: { colors: { glass: "rgba(255,255,255,0.1)" } } } }\` }</script>
                  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet" />
                </head>
                <body className="bg-black text-white antialiased overflow-hidden">{children}</body>
              </html>
            )
          }
          EOF

          # 2. PAGE (İnterfeys)
          cat <<EOF > app/page.tsx
          "use client";
          import React, { useState } from 'react';
          // İkonlar üçün sadə SVG-lər işlədirik (Xəta olmasın)
          const IconZap = () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon></svg>;
          const IconCode = () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="16 18 22 12 16 6"></polyline><polyline points="8 6 2 12 8 18"></polyline></svg>;
          const IconPlay = () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>;
          const IconSettings = () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg>;

          export default function Dashboard() {
            const [prompt, setPrompt] = useState("");
            const [generating, setGenerating] = useState(false);

            const handleGen = () => {
              setGenerating(true);
              setTimeout(() => setGenerating(false), 2500);
            }

            return (
              <div className="flex h-screen w-full bg-black text-white font-sans">
                {/* SIDEBAR */}
                <div className="w-20 md:w-64 border-r border-white/10 flex flex-col bg-zinc-950">
                  <div className="h-16 flex items-center gap-3 px-6 border-b border-white/10">
                    <div className="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center shadow-[0_0_15px_rgba(37,99,235,0.5)]">
                      <IconZap />
                    </div>
                    <span className="hidden md:block font-bold text-lg tracking-tight">AppFactory</span>
                  </div>
                  
                  <div className="p-4 space-y-2">
                    <div className="flex items-center gap-3 p-3 bg-white/5 rounded-lg border border-white/10 text-white cursor-pointer hover:bg-white/10 transition">
                      <IconCode /> <span className="hidden md:block">Editor</span>
                    </div>
                    <div className="flex items-center gap-3 p-3 text-gray-400 hover:text-white cursor-pointer hover:bg-white/5 rounded-lg transition">
                      <IconSettings /> <span className="hidden md:block">Settings</span>
                    </div>
                  </div>
                  
                  <div className="mt-auto p-6 border-t border-white/10">
                    <div className="flex items-center gap-3">
                      <div className="w-10 h-10 rounded-full bg-gradient-to-tr from-purple-500 to-blue-500"></div>
                      <div className="hidden md:block">
                        <p className="text-sm font-medium">Admin User</p>
                        <p className="text-xs text-gray-500">Pro Plan</p>
                      </div>
                    </div>
                  </div>
                </div>

                {/* MAIN CONTENT */}
                <div className="flex-1 flex flex-col relative overflow-hidden bg-gradient-to-br from-black via-zinc-900 to-black">
                  {/* HEADER */}
                  <header className="h-16 border-b border-white/10 flex items-center justify-between px-8 bg-black/50 backdrop-blur-md sticky top-0 z-10">
                    <div className="text-sm text-gray-400">Project / <span className="text-white">New AI App</span></div>
                    <button className="bg-blue-600 hover:bg-blue-500 text-white px-5 py-2 rounded-md text-sm font-medium flex items-center gap-2 shadow-lg transition-all">
                      <IconPlay /> Deploy App
                    </button>
                  </header>

                  {/* WORKSPACE */}
                  <div className="flex-1 flex p-6 gap-6">
                    
                    {/* INPUT AREA */}
                    <div className="w-full md:w-1/3 flex flex-col gap-4">
                      <div className="flex-1 bg-zinc-900/50 border border-white/10 rounded-xl p-6 flex flex-col backdrop-blur-sm">
                        <h2 className="text-xl font-semibold mb-2 bg-gradient-to-r from-blue-400 to-purple-500 bg-clip-text text-transparent">AI Architect</h2>
                        <p className="text-gray-400 text-sm mb-6">Describe your dream app logic below.</p>
                        
                        <div className="flex-1 overflow-y-auto space-y-4 mb-4 pr-2">
                          <div className="bg-white/5 p-4 rounded-lg border border-white/5 text-sm text-gray-300">
                             Hello! I'm ready to build. Try: "Create a CRM for a real estate agency".
                          </div>
                          {generating && (
                            <div className="bg-blue-500/10 border border-blue-500/20 p-4 rounded-lg text-sm text-blue-200 animate-pulse">
                               Generating database schema... <br/> Designing UI components...
                            </div>
                          )}
                        </div>

                        <div className="relative">
                          <textarea 
                            value={prompt}
                            onChange={(e) => setPrompt(e.target.value)}
                            placeholder="Type your idea here..."
                            className="w-full h-32 bg-black/50 border border-white/20 rounded-xl p-4 text-sm focus:outline-none focus:border-blue-500 transition resize-none text-white placeholder-gray-600"
                          ></textarea>
                          <button 
                            onClick={handleGen}
                            className="absolute bottom-4 right-4 bg-white text-black p-2 rounded-lg hover:scale-105 transition active:scale-95"
                          >
                            <IconZap />
                          </button>
                        </div>
                      </div>
                    </div>

                    {/* PREVIEW AREA */}
                    <div className="hidden md:flex flex-1 bg-black border border-white/10 rounded-xl overflow-hidden flex-col shadow-2xl relative">
                      <div className="h-10 bg-zinc-900 border-b border-white/10 flex items-center px-4 gap-2">
                        <div className="w-3 h-3 rounded-full bg-red-500/20 border border-red-500/50"></div>
                        <div className="w-3 h-3 rounded-full bg-yellow-500/20 border border-yellow-500/50"></div>
                        <div className="w-3 h-3 rounded-full bg-green-500/20 border border-green-500/50"></div>
                        <div className="ml-auto text-xs text-gray-600 font-mono">preview.localhost:3000</div>
                      </div>
                      
                      <div className="flex-1 flex items-center justify-center bg-[radial-gradient(ellipse_at_center,_var(--tw-gradient-stops))] from-zinc-900 via-black to-black">
                        {generating ? (
                          <div className="text-center">
                            <div className="w-16 h-16 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"></div>
                            <p className="text-gray-400 animate-pulse">Building Application...</p>
                          </div>
                        ) : (
                          <div className="text-center opacity-30">
                            <div className="w-20 h-20 bg-white/10 rounded-xl mx-auto mb-4 flex items-center justify-center">
                              <IconCode />
                            </div>
                            <p className="text-gray-500">App Preview Area</p>
                          </div>
                        )}
                      </div>

                      {/* DECORATIVE GLOW */}
                      <div className="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[500px] h-[500px] bg-blue-600/10 blur-[100px] pointer-events-none rounded-full"></div>
                    </div>

                  </div>
                </div>
              </div>
            );
          }
          EOF

          # 3. Package.json (Sadə saxlayırıq ki, tez işləsin)
          cat <<EOF > package.json
          {
            "name": "ai-factory-ui",
            "version": "1.0.0",
            "scripts": { "dev": "next dev", "build": "next build", "start": "next start" },
            "dependencies": { "next": "latest", "react": "latest", "react-dom": "latest" }
          }
          EOF

          git config --global user.name 'FixBot'
          git config --global user.email 'bot@fix.com'
          git add .
          git commit -m "Deploy CDN Forced UI"
          git push
